


Network Working Group                                          M. Miller
Internet-Draft                                       Cisco Systems, Inc.
Intended status: Standards Track                        January 14, 2013
Expires: July 18, 2013


   Using JSON Web Encryption (JWE) for Protecting JSON Web Key (JWK)
                                Objects
                        draft-miller-xmpp-e2e-03

Abstract


Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on July 18, 2013.

Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.







Miller                    Expires July 18, 2013                 [Page 1]

Internet-Draft              JWE Protected JWK               January 2013


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . 3
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . . . 3
   3.  Protecting Keys . . . . . . . . . . . . . . . . . . . . . . . . 3
     3.1.  Process . . . . . . . . . . . . . . . . . . . . . . . . . . 3
     3.2.  Private Key Example . . . . . . . . . . . . . . . . . . . . 3
     3.3.  Symmetric key Example . . . . . . . . . . . . . . . . . . . 4
   4.  Using Passwords . . . . . . . . . . . . . . . . . . . . . . . . 4
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . . . 4
   6.  Security Considerations . . . . . . . . . . . . . . . . . . . . 4
   7.  Normative References  . . . . . . . . . . . . . . . . . . . . . 4
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . . . 4






































Miller                    Expires July 18, 2013                 [Page 2]

Internet-Draft              JWE Protected JWK               January 2013


1.  Introduction

   Say something about why wrapping keys is worthwhile.

   Say something about why re-using JWE semantics is worthwhile.


2.  Terminology

   This document inherits JSON Web Algorithms (JWA)-related terminology
   from [JOSE-JWA], JSON Web Encryption (JWE)-related terminology from
   [JOSE-JWE], JSON Web Key (JWK)-related terminology from [JOSE-JWK],
   and password-based cryptography-related terminology from [RFC2898].
   Security-related terms are to be understood in the sense defined in
   [RFC4949].

   The capitalized key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
   "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [RFC2119].


3.  Protecting Keys

3.1.  Process

   The process for protecting private keys and symmetric keys is
   idential.  To protect a key, the key holder performs the following
   steps:

   1.  Converts the JWK object to a UTF-8 encoded string (K').

   2.  Performs the message encryption steps from [JOSE-JWE] to generate
       the JWE header H, JWE Encrypted Key E, JWE Initialization Vector
       IV, JWE Ciphertext C, and JWE Integrity Value I, using the
       following inputs:

       *  The 'alg' property set to the intented key encryption
          algorithm (e.g.  "RSA-OAEP", or "PBES2-H512+A256KW" from
          below).

       *  The 'enc' property set to the intended content encryption
          algorithm (e.g.  "A256GCM" or "A256CBC+HS512").

       *  K' as the plaintext content to encrypt.

3.2.  Private Key Example




Miller                    Expires July 18, 2013                 [Page 3]

Internet-Draft              JWE Protected JWK               January 2013


3.3.  Symmetric key Example


4.  Using Passwords


5.  IANA Considerations


6.  Security Considerations


7.  Normative References

   [JOSE-JWA]
              Jones, M., "JSON Web Algorithms (JWA)",
              draft-ietf-jose-json-web-algorithms-08 (work in progress),
              December 2012.

   [JOSE-JWE]
              Jones, M., Rescola, E., and J. Hildebrand, "JSON Web
              Encryption (JWE)", draft-ietf-jose-json-web-encryption-08
              (work in progress), December 2012.

   [JOSE-JWK]
              Jones, M., "JSON Web Key (JWK)",
              draft-ietf-jose-json-web-key-08 (work in progress),
              December 2012.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2898]  Kaliski, B., "Password-Based Cryptography Specification",
              RFC 2898, September 2000.

   [RFC4686]  Josefsson, S., "The Base16, Base32, and Base64 Data
              Encodings", RFC 4648, October 2006.

   [RFC4949]  Shirey, R., "Internet Security Glossary, Version 2",
              RFC 4949, August 2007.











Miller                    Expires July 18, 2013                 [Page 4]

Internet-Draft              JWE Protected JWK               January 2013


Author's Address

   Matthew Miller
   Cisco Systems, Inc.
   1899 Wynkoop Street, Suite 600
   Denver, CO  80202
   USA

   Phone: +1-303-308-3204
   Email: mamille2@cisco.com









































Miller                    Expires July 18, 2013                 [Page 5]

